<div class="row mb-4">
  <div class="col">
    <h2 class="title" style="color: white; margin-left: 100px;" >{{ companyName }}</h2>
  </div>
</div>
<div class="container mt-4">
  <div class="row">

    <div class="col-md-6">
      <!-- Tablo 1 -->
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Ürün</th>
              <th scope="col">Kg/adet</th>
              <th scope="col">Tarih</th>
              <th scope="col"></th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let givenProduct of givenProducts">
              <th scope="row">{{ givenProduct.id }}</th>
              <td>{{ givenProduct.productName }}</td>
              <td>{{ givenProduct.stock }}</td>
              <td>{{ (givenProduct.createdAt || givenProduct.updatedAt) | date: 'dd/MM/yyyy '  }}</td>
              <td>
                <button class="btn btn-warning btn-sm" (click)="openEditModal(givenProduct)">Düzenle</button>
              </td>
              <td>
                <button class="btn btn-danger btn-sm"(click)="deleteGivenProduct(givenProduct.id)">Sil</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tablo 2 -->
    <div class="col-md-6">
      <div class="table-container">
          <table class="table">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Ürün</th>
                  <th scope="col">Miktar</th>
                  <th scope="col">Miktar başına fiyat</th>
                  <th scope="col">Kazanç</th>
                  <th scope="col">Tarih</th>       
                  <th scope="col"></th>
                  <th scope="col"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let sale of sales">
                  <th scope="row">{{ sale.id }}</th>
                  <td>{{ sale.product?.name}}</td>
                  <td>{{ sale.quantity }}</td>
                  <td>{{ sale.price }}</td>
                  <td>{{ sale.totalSum }}</td>
                  <td>{{ (sale.createdAt || sale.updatedAt) | date: 'dd/MM/yyyy '  }}</td>
                  <td>
                    <button class="btn btn-warning btn-sm" (click)="openSaleEditModal(sale)">Düzenle</button>
                  </td>
                  <td>
                    <button class="btn btn-danger btn-sm" (click)="deleteSale(sale.id)">Sil</button>
                  </td>
                </tr>
              </tbody>
            </table>
      </div>
    </div>

  <!-- Form Alanı -->
  <div class="row mt-4">
    <div class="col-md-6">
      <!-- Gider Ekle Formu -->
      <div class="form-container">
        <label for="productSelect" class="form-label text-white">Şirkete verilen Ürün</label>
        <div class="form-content">
          <!-- Ürün Seçimi -->
          <select id="productSelect" class="form-control" [(ngModel)]="productId">
            <option [ngValue]="undefined" disabled >Ürün Seçiniz</option>
            <option *ngFor="let product of products" [ngValue]="product.id">{{ product.name }}</option>
          </select>
          <input type="number" class="form-control mt-2" [(ngModel)]="stock" placeholder="Stok (Kg/Adet)" />
          <button class="btn btn-primary mt-2" (click)="addGivenProduct()">Ekle</button>
        </div>
      </div>
    </div>
    

    <div class="col-md-6">
      <!-- Gider Getir Formu -->
     
      <div class="form-container">
          <label for="fruitSelect" class="form-label text-white">Ürün Satışı Gir</label>
          <div class="form-content">
            <select id="fruitSelect" name="fruit" [(ngModel)]="selectedProductName">
              <option [ngValue]="null" disabled>Ürün Seçiniz</option>
              <option *ngFor="let product of products" [ngValue]="product.name">{{ product.name }}</option>
            </select>
            <input type="number" class="form-control" id="quantityInput" [(ngModel)]="newSaleQuantity" placeholder="Miktar">
            <input type="number" class="form-control" id="priceInput" [(ngModel)]="newSalePrice" placeholder="Miktar Başına Fiyat">
            
            <button class="btn btn-primary" (click)="addSale()" >Ekle</button>
          </div>
        </div>

  </div>
</div>
<!-- tablo 1 düzenleme formu -->
<div class="edit-form-container" *ngIf="selectedGivenProduct">
  <h4> Güncelle</h4>
  <form (ngSubmit)="updateGivenProduct()">
    <div class="form-group">
      <label for="editAmountInput">Gider Miktarı</label>
      <input type="number" class="form-control" [(ngModel)]="selectedGivenProduct.stock" id="stockInput" name="stock" required>
    </div>
    <div class="form-group">
      <label for="editExpanseTypeInput">Gider Türü</label>
      <select class="form-control" [(ngModel)]="selectedGivenProduct.productId" id="productNameInput" name="productName" required>
        <option [ngValue]="undefined" disabled>Gider türünü seçiniz</option>
        <option *ngFor="let product of products" [ngValue]="product.id">{{ product.name }}</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary">Güncelle</button>
    <button type="button" class="btn btn-secondary" (click)="cancelEdit()">İptal</button>
  </form>
</div>
</div>
<!-- tablo 2 düzenleme formu -->
<div class="edit-form-container" *ngIf="selectedSale">
  <h4> Satış Güncelle</h4>
  <form (ngSubmit)="updateSale()">
    <div class="form-group">
      <label for="editSaleQuantityInput">Satış Miktarı</label>
      <input type="number" class="form-control" [(ngModel)]="selectedSale.quantity" id="editSaleQuantityInput" name="quantity" required>
    </div>
    <div class="form-group">
      <label for="editSalePriceInput">Satış Fiyatı</label>
      <input type="number" class="form-control" [(ngModel)]="selectedSale.price" id="editSalePriceInput" name="price" required>
    </div>
    <div class="form-group">
      <label for="editProductSelect">Ürün</label>
      <select class="form-control" [(ngModel)]="selectedSale.product" id="editProductSelect" name="productId" required>
        <option [ngValue]="undefined" disabled>Ürün Seçiniz</option>
        <option *ngFor="let product of products" [ngValue]="product">{{ product.name }}</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary" (click)="updateSale()">Güncelle</button>
    <button type="button" class="btn btn-secondary" (click)="cancelSaleEdit()">İptal</button>
  </form>
</div>



